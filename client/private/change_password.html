<!-- 
=========================================================
* SysLogMe change_password.html
=========================================================
* Created by pierre.gremaud@bluewin.ch
* April 2022
*
--> 
<!DOCTYPE html> 
<html lang="en"> 
    <head> 
        <meta charset="utf-8"/> 
        <meta name="author" content="pierre.gremaud@bluewin.ch"/> 
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/> 
        <title>Change Password</title>         
     
        <!-- Bootstrap core CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
        
        <!-- Custom styles for this template       -->         
        <link rel="stylesheet" type="text/css" href="../assets/css/private_style.css"/> 
    </head>     
    <body> 

        <!-- Sidebar  -->  
        <nav class="sidebar wb-sidebar" id="sidebar"> 

            <div class="sidebar-header wb-sidebar-header"> 
                <img src="../assets/img/logo-white-no-bg-extra-small.png" alt="SysLogMe" class="rounded me-auto d-block"/>
            </div>

            <ul class="components"> 
                <li class="nav-item" id="dashboardNavItem" style="display: none;">
                    <a class="nav-link" id="dashboardNavLink" href="./dashboard.html">
                        <i class="bi bi-house"></i> 
                        Dashboard
                    </a> 
                </li>                 
                <li class="nav-item" id="contactNavItem" style="display: none;">
                    <a class="nav-link" id="contactNavLink" href="./contact.html">
                        <i class="bi bi-shuffle"></i> 
                        Contact
                    </a> 
                </li>
                <li class="nav-item" id="changePwdNavItem" style="display: none;">
                    <a class="nav-link" id="changePwdNavLink" href="#" onclick="location.href='./change_password.html';">
                        <i class="bi bi-eye"></i>
                        Change Password
                    </a>
                </li>
                <li class="nav-item" id="logoutNavItem" style="display: none;">
                    <a class="nav-link" id="contactNavLink" href="#" onclick="commonFunction.logout();">
                        <i class="bi bi-door-open"></i>
                        Logout
                    </a>
                </li>               
            </ul>
        </nav> 
        <!-- End Sidebar  -->

        <!-- Page Content  -->             
        <div id="content">

            <!-- Navbar  --> 
            <nav class="navbar wb-navbar navbar-expand-lg navbar-light bg-light">

                <div class="container-fluid">
                        
                    <button class="sidebar-collapse navbar-toggler ms-auto" type="button">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div> 
                        <p class="navbar-brand mt-3" id="page-name">page-name</p> 
                    </div>

                    <div class="collapse navbar-collapse">

                        <i class="sidebar-collapse bi bi-arrow-left-circle-fill pr-3" style="font-size: 2.5rem; color:#66615B;"></i>
                        <i class="sidebar-collapse bi bi-arrow-right-circle-fill pr-3" style="font-size: 2.5rem; color:#66615B;"></i>

                        <ul class="navbar-nav ms-auto">
                            
                            <li class="nav-item">
                                <a class="nav-link wb-nav-link" style="color:black; font-size: 1.1rem;">
                                    Logged in as :
                                    <span class="wb-navbar-span" id="navUserName">username</span>
                                </a>
                            </li>

                        </ul>
                    </div>
                </div>
            </nav> 
            <!-- End Navbar  -->

            <!-- Begin of Main pannel -->                 
            <main role="main" class=""> 
                     
                <div class="col-md-8"> 
                    <div class="card wb-card-shadow"> 
                        <div class="card-header"> 
                            <h4 id="card-title" class="card-title">Change your Password</h4>
                        </div>                             
                        <div class="card-body">

                            <a id="card-sub-title" class="card-text">Use this form to change your password</a> 

                            <form class="row needs-validation mt-2" id="form" autocomplete="off" novalidate>

                                <label class="form-label wb-form-label" for="current-password">Current Password</label>                                
                                <div class="input-group mb-3"> 
                                    <input class="form-control" type="password" id="current-password"  minlength="3" required/> 

                                    <div class="input-group-append">
                                        <span class="input-group-text" onclick="commonFunction.togglePassword(this);">
                                            <i class="bi bi-eye"></i>
                                            <i class="bi bi-eye-slash d-none"></i>
                                        </span>
                                    </div>
                                    
                                    <div class="invalid-feedback"> 
                                        Password is invalid or missing
                                    </div>
                                </div> 

                                <label class="form-label wb-form-label" for="new-password">New Password</label>                                
                                <div class="input-group mb-3">                                      
                                    <input type="password" id="new-password" class="form-control" minlength="3" oninput="commonFunction.comparePassword(this, document.getElementById('retype-password'))" required/> 

                                    <div class="input-group-append">
                                        <span class="input-group-text" onclick="commonFunction.togglePassword(this);">
                                            <i class="bi bi-eye"></i>
                                            <i class="bi bi-eye-slash d-none"></i>
                                        </span>
                                    </div>

                                    <div class="invalid-feedback"> 
                                        Password is invalid or missing
                                    </div>                                         
                                </div>

                                <label class="form-label wb-form-label" for="retype-password">Retype New Password</label>                                
                                <div class="input-group mb-3">                                          
                                    <input type="password" id="retype-password" class="form-control" minlength="3" oninput="commonFunction.comparePassword(this, document.getElementById('new-password'))" required></input>
                                    <div class="input-group-append">
                                        <span class="input-group-text" onclick="commonFunction.togglePassword(this);">
                                            <i class="bi bi-eye"></i>
                                            <i class="bi bi-eye-slash d-none"></i>
                                        </span>
                                    </div>                                    
                                    <div class="invalid-feedback">
                                        Password is invalid or missing
                                    </div>                                        
                                    <br/>                                    
                                </div>

                                <label class="form-label wb-form-label mb-3">
                                    By clicking below button your new password will be <strong>immediately in effect</strong>
                                </label>     

                                <button class="btn btn-primary btn-block" type="button" onclick="changePassword.changePassword()">
                                    Change Password
                                </button>                                         

                            </form>                              

                        </div>                             
                    </div>                         
                </div>                     
            </main>
            <!-- End of Main pannel -->                 
        </div>             
    
        <!--  Vendor JS Script  -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap/dist/js/bootstrap.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2/dist/sweetalert2.all.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/localstorage-slim/dist/localstorage-slim.js"></script> 

        <!-- Custom JS -->    
        <script src="../assets/js/global/common_function.js"></script>
        <script src="../assets/js/global/server_request.js"></script>
        <script src="../assets/js/global/client_session.js"></script>
        <script src="../assets/js/private/change_password.js"></script>  

        <!-- Custom JS Script   -->         
        <script>

            //redirects if user is not logged
            commonFunction.checkClientSession();

            //loads the navbar
            commonFunction.loadPrivateNavBar("Change Password", "changePwdNavItem");
              
        </script>
        <script> 
        
            //check if a password was passed as GET param
            const pwd = commonFunction.findGetParameter('pwd');

            //if a password was passed as GET param then the user has forgotten his password and the server redirect him to this page
            if (pwd) {

                //populate current password input field
                document.getElementById('current-password').value = pwd;

                //disable current password input field
                document.getElementById('current-password').disabled = true;                  
            }
        </script> 
    </body>     
</html>
